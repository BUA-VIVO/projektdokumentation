
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="This document is part of the vivo project documentation">
      
      
        <meta name="author" content="Florian Kotschka,  Rolf Guescini">
      
      
      
        <link rel="prev" href="../clusters/">
      
      
        <link rel="next" href="../pipelines/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.6">
    
    
      
        <title>Mongo import - VIVO Project Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.558e4712.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.2505c338.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="light-blue">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#import-into-mongodb" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="VIVO Project Documentation" class="md-header__button md-logo" aria-label="VIVO Project Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            VIVO Project Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Mongo import
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="light-blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="cyan"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/BUA-VIVO/projektdokumentation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    BUA-VIVO/projektdokumentation
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href=".." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../OpenStackServers/" class="md-tabs__link md-tabs__link--active">
        Technical Documentation
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../ontologien/" class="md-tabs__link">
        Ontologies
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../vokabularen/" class="md-tabs__link">
      Vocabularies
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="VIVO Project Documentation" class="md-nav__button md-logo" aria-label="VIVO Project Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    VIVO Project Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/BUA-VIVO/projektdokumentation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    BUA-VIVO/projektdokumentation
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2" tabindex="0" aria-expanded="true">
          Technical Documentation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Technical Documentation" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Technical Documentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../OpenStackServers/" class="md-nav__link">
        OpenStack and Server
      </a>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2_2" tabindex="0" aria-expanded="false">
          Servers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Servers" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Servers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../vivo/" class="md-nav__link">
        Vivo Server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../solrserver/" class="md-nav__link">
        Solr Server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mongoserver/" class="md-nav__link">
        Mongo Server
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../testserver/" class="md-nav__link">
        Testserver
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kairntech/" class="md-nav__link">
        Kairntech
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_2_3" type="checkbox" id="__nav_2_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2_3" tabindex="0" aria-expanded="true">
          Pipelines
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Pipelines" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          Pipelines
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_2_3_1" type="checkbox" id="__nav_2_3_1" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2_3_1" tabindex="0" aria-expanded="true">
          VIVO Package
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="VIVO Package" data-md-level="3">
        <label class="md-nav__title" for="__nav_2_3_1">
          <span class="md-nav__icon md-icon"></span>
          VIVO Package
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../clusters/" class="md-nav__link">
        Cluster scripts
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Mongo import
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Mongo import
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#setting-up-a-database" class="md-nav__link">
    Setting up a Database
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
    <nav class="md-nav" aria-label="Prerequisites">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mongoengine" class="md-nav__link">
    Mongoengine
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#db-schema" class="md-nav__link">
    DB Schema
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pipeline" class="md-nav__link">
    Pipeline
  </a>
  
    <nav class="md-nav" aria-label="Pipeline">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#main" class="md-nav__link">
    Main
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#entities" class="md-nav__link">
    Entities
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#relations" class="md-nav__link">
    Relations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pipelines/" class="md-nav__link">
        Mongo2Vivo
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_2_3_2" type="checkbox" id="__nav_2_3_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2_3_2" tabindex="0" aria-expanded="false">
          Classification pipelines
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Classification pipelines" data-md-level="3">
        <label class="md-nav__title" for="__nav_2_3_2">
          <span class="md-nav__icon md-icon"></span>
          Classification pipelines
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../vorklassifikationspipelines/" class="md-nav__link">
        Automatic pre classification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api-klassifikationspipelines/" class="md-nav__link">
        API import and classification
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" tabindex="0" aria-expanded="false">
          Ontologies
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Ontologies" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Ontologies
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ontologien/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../bua-ontology/" class="md-nav__link">
        BUA VIVO Upper Ontology
      </a>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " data-md-toggle="__nav_3_3" type="checkbox" id="__nav_3_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3_3" tabindex="0" aria-expanded="false">
          Alliance member Ontologies
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Alliance member Ontologies" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          Alliance member Ontologies
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../organigram/" class="md-nav__link">
        Organigram ontologies
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../charite-ontology/" class="md-nav__link">
        Charité – Universitätsmedizin Berlin Ontology Extension
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../fub-ontology/" class="md-nav__link">
        Freie Universität Berlin Ontology Extension
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../vivo-core/" class="md-nav__link">
        Berlin University Alliance VIVO   Ontology Extension
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../vokabularen/" class="md-nav__link">
        Vocabularies
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  



<h1 id="import-into-mongodb">Import into MongoDB</h1>
<p>The information extracted by the <a href="https://bua-vivo.github.io/projektdokumentation/clusters/">Cluster Scripts</a> are transferred into a MongoDB Database on the <a href="https://bua-vivo.github.io/projektdokumentation/mongoserver/">MongoDB-Server</a>. A python <a href="https://github.com/BUA-VIVO/bua-vivo-pipelines/blob/main/VivoPackage/Input2Mongo.py">script</a> is used to facilitate the transfer.  A second <a href="https://github.com/BUA-VIVO/bua-vivo-pipelines/blob/main/VivoPackage/mongo/dbSchema.py">script</a> defines the MongoDB-Classes.</p>
<h2 id="setting-up-a-database">Setting up a Database</h2>
<p>The reccomended way to set up a database is the using MongoDB Compass App.
The sidebar button <code>new Connection</code> lets connect to the MongoDB-Server using a URI.<br />
The  string has the follwing format:</p>
<pre><code>mongodb://USERNAME:PASSWORD@ServerIP:PORT/
</code></pre>
<p>The Mongo Standard Port is 27017.</p>
<p>After a connection is establishes the sidebar offers shortlinks for <code>My Queries</code> and <code>Databases</code>. Behind the Databases-Link the <code>+</code>-Symbol creates a new Database. <br />
Databases are deleted if all Collections inside are deleted. It is advised to create an empty Admin-Collection inside the every new Database, to avoid the deletion of the Database in case of a reset.   </p>
<h2 id="prerequisites">Prerequisites</h2>
<h3 id="mongoengine">Mongoengine</h3>
<p>To establish connections between Python and MongoDB <a href="https://pypi.org/project/mongoengine/">mongoengine</a> is used. To install use:</p>
<pre><code>pip install mongoengine
</code></pre>
<p>For further documentation see the projects <a href="https://mongoengine-odm.readthedocs.io/apireference.html">read the docs</a>.</p>
<h3 id="db-schema">DB Schema</h3>
<p>In mongoengine, MongoDB Collections are defined using DB Schemas represented by Classes. Since MongoDB itself does not enforce schemata, and since schemata should be open to future additions, minimal schemata were used.<br />
Every Schema is defined in a Class which inherits from the DynamicDocument-Class. This allows to expand entries dynamically and retroactively. This offers the option of expanding on information stored as new data points become available.</p>
<p>The database is designed around the Vivo frontend. Therefore every entry in every database needs to have a name in order to be displayed in Vivo. Other data points are optional, even though in most cases a set of standard data points will form organically.<br />
The example shows the <code>Cluster</code>-Class. All other classes function comparably.  </p>
<pre><code class="language-py">class Cluster(DynamicDocument):
    name = StringField(required=True)
</code></pre>
<p>The Classes are defined in the <a href="https://github.com/BUA-VIVO/bua-vivo-pipelines/blob/main/VivoPackage/mongo/dbSchema.py">dbSchema.py</a>.</p>
<h2 id="pipeline">Pipeline</h2>
<h3 id="main">Main</h3>
<p>The <a href="https://github.com/BUA-VIVO/bua-vivo-pipelines/blob/main/VivoPackage/Input2Mongo.py">Input2Mongo.py</a> functions as main handler for the pipeline.</p>
<p>It loads the Classes defined in the <a href="https://bua-vivo.github.io/projektdokumentation/clusters/">Cluster Scripts</a> and instantiates them. An Import-List can be defined for the case, that only certain Clusters are to be imported.</p>
<pre><code class="language-py"># load Cluster
moa = MattersOfActivity()
nc = NeuroCure()
sci = SCIoI()

# Define Clusters to import into MongoDB
importList = [moa,nc,sci]
</code></pre>
<p>Afterwards two additional Scripts are excecuted:
- <a href="https://github.com/BUA-VIVO/bua-vivo-pipelines/blob/main/VivoPackage/mongo/mongoPipelineForEntities.py">mongoPipelineForEntities</a>: writes singular entities (Cluster, Person,Project,Publication,Journal, Year) into the MongoDB
- <a href="https://github.com/BUA-VIVO/bua-vivo-pipelines/blob/main/VivoPackage/mongo/mongoPipelineForRelations.py">mongoPipelineForRelations</a>: writes relational data and connects the singular entities in the mongodb</p>
<h3 id="entities">Entities</h3>
<p>To transfer the entities into the MongoDB, a connection between the Script and the Database has to be established.</p>
<p>This is done using the <code>mongoengine</code>-Library:  </p>
<pre><code class="language-py">from mongoengine import *
</code></pre>
<p>The connection is established with the same URI used under "Setting up a Database". Before the connection is established, <code>disconnect()</code> is used to make sure no other connection is stil active.</p>
<pre><code class="language-py">MONGOURI: &quot;mongodb://USERNAME:PASSWORD@ServerIP:PORT/&quot;
disconnect()
connect(host=MONGOURI)
</code></pre>
<p>The clusterList is the list of Clusters defined in the "Main" section above. The methodList is a list of strings correlating to the Methods defined under <a href="https://bua-vivo.github.io/projektdokumentation/clusters/#classes-and-methods">Classes and Methods</a> in the documentation of the Cluster Scripts.</p>
<pre><code class="language-py">clusterList = importlist
methodList = ['Person','Cluster','Project','Publication','Journal']
</code></pre>
<p>The pipeline iterates over every Method per Cluster.
A try-except is used to make sure the used Method is defined in the respective Cluster Script. If a Method is not found a print statement informs about the Error and the Pipeline continues with the next Method.
If the Method is found, it is excecuted and the result is assigned to the variable <code>entityList</code>.</p>
<pre><code class="language-py">try:
     meth = getattr(cluster,method)
 except:
     print(cluster.__name__(),method,'not found')
 else:
     entityList = meth()
</code></pre>
<p>Afterwards every single entity is preccessed according to the method that produced it. TQDM is simply used for visual status representation and can be omitted.</p>
<pre><code class="language-py">for entity in tqdm(entityList):
  if method == 'Person':
    ...
  elif method == 'Cluster':
    ...
</code></pre>
<p><strong>Person:</strong><br />
First, middle and last name of an entity are read from the person dictionary.</p>
<pre><code class="language-py">firstName = entity['firstName']
middleName = entity['middleName']
lastName = entity['lastName']
</code></pre>
<p>Then all objects are loaded from the MongoDB, where first and last name match the entity data.</p>
<pre><code class="language-py">db = Person.objects(__raw__={'$and':[
                            {&quot;firstName&quot;:{&quot;$in&quot;:[firstName]}},
                            {&quot;lastName&quot;:{&quot;$in&quot;:[lastName]}}
                                ]})
</code></pre>
<p>If a matching dataset exists in the MongoDB, its information is updated to represent, that it is part of the current cluster.</p>
<pre><code class="language-py">if db:
  updateOwnership(db,cluster)
</code></pre>
<p>The updateOwnership Function is incorporated in the <a href="https://github.com/BUA-VIVO/bua-vivo-pipelines/blob/main/VivoPackage/mongo/tools.py">tools.py</a>. It opens the corresponding database entry, checks if the cluster is already part of the flag_owner entry and adds it, if that is not already the case.</p>
<pre><code class="language-py">def updateOwnership(db,cluster):
    obj = db[0]
    owner = obj.flag_owner
    if cluster.__name__() not in owner:
        owner.append(cluster.__name__())
        obj.flag_owner = owner
        obj.save()
</code></pre>
<p>In case no matching Dataset is found in the MongoDB, a new entry is created and saved. While creating the entry, a conditional for middle name inclusion is executed when the full name is created. The flag for the owning cluster is also saved as part of the entry.</p>
<pre><code class="language-py">if middleName == '':
    name = firstName+' '+lastName
else:
    name = firstName+' '+middleName+' '+lastName
Person(name= name,firstName = firstName, middleName=middleName,lastName=lastName,flag_owner=[cluster.__name__()]).save()
</code></pre>
<p><strong>Cluster, Projects and Journals:</strong><br />
The Cluster-, Projects- and Journal-pipelines works comparibly. They check for errors in the name variable before loading the respective dataset with the corresponding name. If this dataset exists, it is updated using the update 'updateOwnership'-Function otherwise it is written and saved to the MongoDB.</p>
<pre><code class="language-py">name = entity['name']
if name not in ['','None']:
    db = Cluster.objects(name=name)
    if db:
        updateOwnership(db,cluster)
    else:
        db = Cluster(name=name,flag_owner=[cluster.__name__()]).save()
</code></pre>
<p><strong>Publications:</strong>  </p>
<p>Publications use the same template. When loading entries from the Database it is not only checked for a matching name but also for a matching publication year. This is done to avoid overwriting Publications with similar names.</p>
<pre><code class="language-py">db = Publication.objects(__raw__={'$and':[
                                  {&quot;name&quot;:{&quot;$in&quot;:[name]}},
                                  {&quot;year&quot;:{&quot;$in&quot;:[year]}}
                                      ]})
</code></pre>
<p><strong>Years:</strong>  </p>
<p>Years are created independently of the cluster loop. For dating purposes inside Vivo, as of right now only years are necessary. An entry for every year between 1500 and 2200 is created. If en error is detected in the Database (e.g. a year in this range is missing) the complete Year-Collection will be newly created and overwritten.</p>
<pre><code class="language-py">yearList = Year.objects()
if not all(item in [x.name for x in yearList] for item in list(range(1500,2200))):
    for year in tqdm(range(1500,2200)):
        yearObject = Year(name = str(year))
        yearObject['@type'] = 'http://vivoweb.org/ontology/core#DateTimeValue'
        yearObject['dateTime'] = str(year)+'-01-01T12:00:00'
        yearObject['dateTimePrecision'] = 'http://vivoweb.org/ontology/core#yearPrecision'
        yearObject.save()
</code></pre>
<h3 id="relations">Relations</h3>
<p>To transfer the entities into the MongoDB, a connection between the Script and the Database has to be established.</p>
<p>This is done using the <code>mongoengine</code>-Library:  </p>
<pre><code class="language-py">from mongoengine import *
</code></pre>
<p>The connection is established with the same URI used under "Setting up a Database". Before the connection is established, <code>disconnect()</code> is used to make sure no other connection is stil active.</p>
<pre><code class="language-py">MONGOURI: &quot;mongodb://USERNAME:PASSWORD@ServerIP:PORT/&quot;
disconnect()
connect(host=MONGOURI)
</code></pre>
<p>The clusterList is the list of Clusters defined in the "Main" section above. The methodList is a list of strings correlating to the Methods defined under <a href="https://bua-vivo.github.io/projektdokumentation/clusters/#classes-and-methods">Classes and Methods</a> in the documentation of the Cluster Scripts.</p>
<pre><code class="language-py">clusterList = importlist
methodList = ['Person','Cluster','Project','Publication','Journal']
</code></pre>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2023 <a href="https://github.com/guescinr" target="_blank" rel="noopener">Rolf Guescini</a> <a href="https://github.com/fkotschka"  target="_blank" rel="noopener">Florian Kotschka</a> 

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../assets/javascripts/workers/search.e5c33ebb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.51d95adb.min.js"></script>
      
    
  </body>
</html>